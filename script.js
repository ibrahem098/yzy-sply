
let products = [
    {
        id: null,
        price: 20,
        title: "TS-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "white",
        isPrinted: true,
        images: ["assets/images/front/TS-01W.jpg", "assets/images/back/TS-01W.jpg"]
    }, {
        id: null,
        price: 20,
        title: "TS-02",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "white",
        isPrinted: true,
        images: ["assets/images/front/TS-02W.jpg", "assets/images/back/TS-02W.jpg"]
    }, {
        id: null,
        price: 20,
        title: "HD-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "white",
        isPrinted: true,
        images: ["assets/images/front/HD-01W.jpg", "assets/images/back/HD-01W.jpg"]
    }, {
        id: null,
        price: 20,
        title: "WB-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "white",
        isPrinted: true,
        images: ["assets/images/front/WB-01W.jpg", "assets/images/back/WB-01W.jpg"]
    }, {
        id: null,
        price: 20,
        title: "RC-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "white",
        isPrinted: true,
        images: ["assets/images/front/RC-01W.jpg", "assets/images/back/RC-01W.jpg"]
    }, {
        id: null,
        price: 20,
        title: "SH-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "white",
        isPrinted: true,
        images: ["assets/images/front/SH-01W.jpg", "assets/images/back/SH-01W.jpg"]
    }, {
        id: null,
        price: 20,
        title: "SP-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "white",
        isPrinted: true,
        images: ["assets/images/front/SP-01W.jpg", "assets/images/back/SP-01W.jpg"]
    }, {
        id: null,
        price: 20,
        title: "SP-06",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "white",
        isPrinted: true,
        images: ["assets/images/front/SP-06W.jpg", "assets/images/back/SP-06W.jpg"]
    }, {
        id: null,
        price: 20,
        title: "SK-01",
        sizes: 1,
        sizeList: null,
        color: "white",
        isPrinted: true,
        images: ["assets/images/front/SK-01W.jpg", "assets/images/back/SK-01W.jpg"]
    }, {
        id: null,
        price: 20,
        title: "TS-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "white",
        images: ["assets/images/front/TS-010W.jpg", "assets/images/back/TS-010W.jpg"]
    }, {
        id: null,
        price: 20,
        title: "TS-02",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "white",
        images: ["assets/images/front/TS-020W.jpg", "assets/images/back/TS-020W.jpg"]
    }, {
        id: null,
        price: 20,
        title: "HD-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "white",
        images: ["assets/images/front/HD-010W.jpg", "assets/images/back/HD-010W.jpg"]
    }, {
        id: null,
        price: 20,
        title: "WB-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "white",
        images: ["assets/images/front/WB-010W.jpg", "assets/images/back/WB-010W.jpg"]
    }, {
        id: null,
        price: 20,
        title: "RC-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "white",
        images: ["assets/images/front/RC-010W.jpg", "assets/images/back/RC-010W.jpg"]
    }, {
        id: null,
        price: 20,
        title: "SH-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "white",
        images: ["assets/images/front/SH-010W.jpg", "assets/images/back/SH-010W.jpg"]
    }, {
        id: null,
        price: 20,
        title: "SP-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "white",
        images: ["assets/images/front/SP-010W.jpg", "assets/images/back/SP-010W.jpg"]

    }, {
        id: null,
        price: 20,
        title: "SP-06",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "white",
        images: ["assets/images/front/SP-060W.jpg", "assets/images/back/SP-060W.jpg"]

    }, {
        id: null,
        price: 20,
        title: "SK-01",
        sizes: 1,
        sizeList: null,
        color: "white",
        isPrinted: false,
        images: ["assets/images/front/SK-010W.jpg", "assets/images/back/SK-010W.jpg"]
    }, {
        id: null,
        price: 20,
        title: "TS-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "gray",
        isPrinted: true,
        images: ["assets/images/front/TS-01G.jpg", "assets/images/back/TS-01G.jpg"]
    }, {
        id: null,
        price: 20,
        title: "TS-02",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "gray",
        isPrinted: true,
        images: ["assets/images/front/TS-02G.jpg", "assets/images/back/TS-02G.jpg"]
    }, {
        id: null,
        price: 20,
        title: "HD-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "gray",
        isPrinted: true,
        images: ["assets/images/front/HD-01G.jpg", "assets/images/back/HD-01G.jpg"]
    }, {
        id: null,
        price: 20,
        title: "WB-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "gray",
        isPrinted: true,
        images: ["assets/images/front/WB-01G.jpg", "assets/images/back/WB-01G.jpg"]
    }, {
        id: null,
        price: 20,
        title: "RC-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "gray",
        isPrinted: true,
        images: ["assets/images/front/RC-01G.jpg", "assets/images/back/RC-01G.jpg"]
    }, {
        id: null,
        price: 20,
        title: "SH-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "gray",
        isPrinted: true,
        images: ["assets/images/front/SH-01G.jpg", "assets/images/back/SH-01G.jpg"]
    }, {
        id: null,
        price: 20,
        title: "SP-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "gray",
        isPrinted: true,
        images: ["assets/images/front/SP-01G.jpg", "assets/images/back/SP-01G.jpg"]
    }, {
        id: null,
        price: 20,
        title: "SP-06",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "gray",
        isPrinted: true,
        images: ["assets/images/front/SP-06G.jpg", "assets/images/back/SP-06G.jpg"]
    }, {
        id: null,
        price: 20,
        title: "SK-01",
        sizes: 1,
        sizeList: null,
        color: "gray",
        isPrinted: true,
        images: ["assets/images/front/SK-01G.jpg", "assets/images/back/SK-01G.jpg"]
    }, {
        id: null,
        price: 20,
        title: "TS-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "gray",
        images: ["assets/images/front/TS-010G.jpg", "assets/images/back/TS-010G.jpg"]
    }, {
        id: null,
        price: 20,
        title: "TS-02",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "gray",
        images: ["assets/images/front/TS-020G.jpg", "assets/images/back/TS-020G.jpg"]
    }, {
        id: null,
        price: 20,
        title: "HD-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "gray",
        images: ["assets/images/front/HD-010G.jpg", "assets/images/back/HD-010G.jpg"]
    }, {
        id: null,
        price: 20,
        title: "WB-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "gray",
        images: ["assets/images/front/WB-010G.jpg", "assets/images/back/WB-010G.jpg"]
    }, {
        id: null,
        price: 20,
        title: "RC-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "gray",
        images: ["assets/images/front/RC-010G.jpg", "assets/images/back/RC-010G.jpg"]
    }, {
        id: null,
        price: 20,
        title: "SH-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "gray",
        images: ["assets/images/front/SH-010G.jpg", "assets/images/back/SH-010G.jpg"]
    }, {
        id: null,
        price: 20,
        title: "SP-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "gray",
        images: ["assets/images/front/SP-010G.jpg", "assets/images/back/SP-010G.jpg"]

    }, {
        id: null,
        price: 20,
        title: "SP-06",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "gray",
        images: ["assets/images/front/SP-060G.jpg", "assets/images/back/SP-060G.jpg"]

    }, {
        id: null,
        price: 20,
        title: "SK-01",
        sizes: 1,
        sizeList: null,
        color: "gray",
        isPrinted: false,
        images: ["assets/images/front/SK-010G.jpg", "assets/images/back/SK-010G.jpg"]
    }, {
        id: null,
        price: 20,
        title: "TS-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "black",
        isPrinted: true,
        images: ["assets/images/front/TS-01B.jpg", "assets/images/back/TS-01B.jpg"]
    }, {
        id: null,
        price: 20,
        title: "TS-02",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "black",
        isPrinted: true,
        images: ["assets/images/front/TS-02B.jpg", "assets/images/back/TS-02B.jpg"]
    }, {
        id: null,
        price: 20,
        title: "HD-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "black",
        isPrinted: true,
        images: ["assets/images/front/HD-01B.jpg", "assets/images/back/HD-01B.jpg"]
    }, {
        id: null,
        price: 20,
        title: "WB-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "black",
        isPrinted: true,
        images: ["assets/images/front/WB-01B.jpg", "assets/images/back/WB-01B.jpg"]
    }, {
        id: null,
        price: 20,
        title: "RC-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "black",
        isPrinted: true,
        images: ["assets/images/front/RC-01B.jpg", "assets/images/back/RC-01B.jpg"]
    }, {
        id: null,
        price: 20,
        title: "SH-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "black",
        isPrinted: true,
        images: ["assets/images/front/SH-01B.jpg", "assets/images/back/SH-01B.jpg"]
    }, {
        id: null,
        price: 20,
        title: "SP-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "black",
        isPrinted: true,
        images: ["assets/images/front/SP-01B.jpg", "assets/images/back/SP-01B.jpg"]
    }, {
        id: null,
        price: 20,
        title: "SP-06",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "black",
        isPrinted: true,
        images: ["assets/images/front/SP-06B.jpg", "assets/images/back/SP-06B.jpg"]
    }, {
        id: null,
        price: 20,
        title: "SK-01",
        sizes: 1,
        sizeList: null,
        color: "black",
        isPrinted: true,
        images: ["assets/images/front/SK-01B.jpg", "assets/images/back/SK-01B.jpg"]
    }, {
        id: null,
        price: 20,
        title: "TS-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "black",
        images: ["assets/images/front/TS-010B.jpg", "assets/images/back/TS-010B.jpg"]
    }, {
        id: null,
        price: 20,
        title: "TS-02",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "black",
        images: ["assets/images/front/TS-020B.jpg", "assets/images/back/TS-020B.jpg"]
    }, {
        id: null,
        price: 20,
        title: "HD-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "black",
        images: ["assets/images/front/HD-010B.jpg", "assets/images/back/HD-010B.jpg"]
    }, {
        id: null,
        price: 20,
        title: "WB-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "black",
        images: ["assets/images/front/WB-010B.jpg", "assets/images/back/WB-010B.jpg"]
    }, {
        id: null,
        price: 20,
        title: "RC-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "black",
        images: ["assets/images/front/RC-010B.jpg", "assets/images/back/RC-010B.jpg"]
    }, {
        id: null,
        price: 20,
        title: "SH-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "black",
        images: ["assets/images/front/SH-010B.jpg", "assets/images/back/SH-010B.jpg"]
    }, {
        id: null,
        price: 20,
        title: "SP-01",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "black",
        images: ["assets/images/front/SP-010B.jpg", "assets/images/back/SP-010B.jpg"]

    }, {
        id: null,
        price: 20,
        title: "SP-06",
        sizes: 3,
        sizeList: [1, 2, 3],
        color: "black",
        images: ["assets/images/front/SP-060B.jpg", "assets/images/back/SP-060B.jpg"]

    }, {
        id: null,
        price: 20,
        title: "SK-01",
        sizes: 1,
        sizeList: null,
        color: "black",
        isPrinted: false,
        images: ["assets/images/front/SK-010B.jpg", "assets/images/back/SK-010B.jpg"]
    }
]
let cart = []

products.forEach((product, index) => {
    product.quantity = 1;
    product.size = 1
    product.id = index + 1
})

let displayAddButton = false;
let proudctsGridElemnt = document.querySelector(".proudctsGrid")
function makeProductGrid() {
    products.forEach((product, index) => {
        proudctHTML = `
<div class="productCard id="${product.id}">
    <img class="proudctImg" src="${product.images[0]}">
    <div class="proudctDetails">
        <div class="info">
            <div class="title">
                <span>${product.title}</span>
            </div>
            <div class="addButtonContiner  hidden">
                <button class=" AddButton fadeable buttonClear ">+</button>
            </div>
        </div>
        <div class="sizeSelectContiner hidden">
            <div class="head ">
                <button class="helpButton  fadeable buttonClear">?</button>
                <span>SELECT SIZE</span>
                <button class="closeButton  fadeable buttonClear">></button>
            </div>
            <div class="sizeList fadeable">
                <div class="sizeNum ">
                    <button class="sizeSet buttonClear" data-id="${product.id}">1</button>
                    <button class="sizeSet buttonClear" data-id="${product.id}">2</button>
                    <button class="sizeSet buttonClear" data-id="${product.id}">3</button>
                </div>
                <div class="sizeTxt hidden">
                    <button class="sizeSet buttonClear" data-id="${product.id}">S-M</button>
                    <button class="sizeSet buttonClear" data-id="${product.id}">M-L</button>
                    <button class="sizeSet buttonClear" data-id="${product.id}">XL-XXL</button>
                </div>
            </div>
        </div>
    </div>
</div>`;

        // proudctHTML = `<div class="productCard" id="${product.id}"><img class="proudctImg" src="${product.images[0]}"><div class="info"><span>${product.title}</span><div class="addButtonContiner hidden"><button class="buttonClear AddButton">+</button></div></div></div>`;
        proudctsGridElemnt.innerHTML += proudctHTML;
    })
}
// make Cart Items HTML 
let cartContinerElemnt = document.querySelector(".cartContiner")
let cartViewElemnt = document.querySelector(".cartView")
let cartItemHTML = ''
function makeCartItemHTML(CartItemObject) {
    cartItemHTML = `<div class="cartItem" data-id="${CartItemObject.id}"><img src="${CartItemObject.images[0]}"><div class="itemDetails">
<div class="itemTag"><span class="itemTitle">${CartItemObject.title}</span><span class="itemPrice">${(CartItemObject.price * CartItemObject.quantity)} USD</span>
</div><div class="itemSizeLine"><span>SIZE</span><span class="itemSize">${CartItemObject.size}</span></div><div class="qtyLine"><span>QTY</span>
<div class="qtySet"><button class="leaveQTY qtyChange" data-id="${CartItemObject.id}">-</button><span class="qty">${CartItemObject.quantity}</span><button class="addQTY qtyChange" data-id="${CartItemObject.id}">+</button></div></div></div></div>`
    return cartItemHTML
}
// calculate total
let totalSpanElemnt = document.querySelector('.totalSpan')
function calculateTotal() {
    let cartTotal = 0
    cart.forEach(cartItem => {
        cartTotal += (cartItem.quantity * cartItem.price)
    })
    totalSpanElemnt.innerText = cartTotal;
}
// No Items
function makeCartHTML() {
    cartViewElemnt.innerHTML = ''
    cart.forEach((cartItem, index) => {
        makeCartItemHTML(cartItem);
        cartViewElemnt.innerHTML += cartItemHTML
    })
    let QTYButtons = document.querySelectorAll(".qtyChange")
    let selectedCartItem;
    QTYButtons.forEach(button => {
        button.addEventListener("click", () => {
            let itemId = parseInt(button.getAttribute("data-id"));
            let selectedCartItem = cart.find(cartItem => cartItem.id === itemId);
            if (selectedCartItem) {
                updateQuantity(selectedCartItem, button.classList[0]);
            }
        })
    })
}

function updateQuantity(selectedCartItem, elemntClass) {
    if (elemntClass === "addQTY") {
        selectedCartItem.quantity++;
    } else {
        if (selectedCartItem.quantity === 1) {
            let index = cart.findIndex(item => item.id === selectedCartItem.id);
            if (index !== -1) {
                cart.splice(index, 1);
            }
        } else {
            selectedCartItem.quantity--;
        }
    }
    calculateTotal()
    updateCounter()
    makeCartHTML()
}

makeProductGrid()
makeCartHTML()

function addToCart(selectedObject, size) {
    let existingCartItem = cart.find(cartItem => cartItem.id === selectedObject.id && cartItem.size === size);

    if (existingCartItem) {
        existingCartItem.quantity++;
    } else {
        cart.push({ ...selectedObject, size, quantity: 1 });
    }

    makeCartHTML();
    updateCounter();
    calculateTotal();
}


let cartTotalElemnt = document.querySelector(".cartTotal")
function updateCounter() {
    let cartItemCount = 0;
    cart.forEach(cartItem => {
        cartItemCount += cartItem.quantity
    })
    cartTotalElemnt.innerText = cartItemCount
    if (cartItemCount === 0) {
        cartTotalElemnt.classList.add("hidden")
    } else {
        cartTotalElemnt.classList.remove("hidden")
    }
}
updateCounter()
calculateTotal()


const addButtons = document.querySelectorAll('.AddButton');
const addButtonContiners = document.querySelectorAll('.addButtonContiner');
const sizeListElemnts = document.querySelectorAll('.sizeList');
let sizeContolsELemnts = document.querySelectorAll('.sizeContols');
let fadeableELemnts = document.querySelectorAll('.fadeable');

function checkFadeableElemntsPositions() {
    const showThreshold = window.innerHeight * 0.5;
    const hideThreshold = window.innerHeight * 0.90;
    fadeableELemnts.forEach((elemnt) => {
        // Get the bounding rectangle of the button
        const rect = elemnt.getBoundingClientRect();

        // Check if the button is between the bottom 5% and 60% of the screen
        if (rect.top <= hideThreshold && rect.bottom >= showThreshold) {
            elemnt.style.opacity = '1';
            // elemnt.classList.remove("hidden")
            // elemnt.classList.remove("noOpacity")
        } else {
            elemnt.style.opacity = '0.1';
            // elemnt.classList.add("noOpacity")
            // elemnt.classList.add("hidden")
        }
    });
}

proudctsGridElemnt.addEventListener('scroll', checkFadeableElemntsPositions);


let productCards = document.querySelectorAll(".productCard");
let sizeSetButtons = document.querySelectorAll(".sizeSet");

sizeSetButtons.forEach((button, index) => {
    button.addEventListener("click", () => {
        let productID = parseInt(button.getAttribute("data-id"));
        let productSize = Number(button.innerText);
        let selectedObject = products.find(product => product.id == productID);
        addToCart(selectedObject, productSize)
        console.log(cart);
    })
})


let infoContainerElemnts = document.querySelectorAll(".info");
let sizeSelectContinerElemnts = document.querySelectorAll(".sizeSelectContiner");
let sizeSloseButtonElemnts = document.querySelectorAll(".closeButton");
let helpButtonElemnts = document.querySelectorAll(".helpButton");
let sizeNumElemnts = document.querySelectorAll(".sizeNum");
let sizeTxtElemnts = document.querySelectorAll(".sizeTxt");
let sizeBoxState = "num";

function showSizeContainer(index) {
    proudctsGridElemnt.scrollBy(0, 1);
    for (let SizeBoxIndex = 0; SizeBoxIndex < productCards.length; SizeBoxIndex++) {
        const sizeSelectContinerElemnt = sizeSelectContinerElemnts[SizeBoxIndex];
        if (SizeBoxIndex === index) {
            infoContainerElemnts[SizeBoxIndex].classList.add("hidden")
            sizeSelectContinerElemnts[SizeBoxIndex].classList.remove("hidden")
        } else {
            infoContainerElemnts[SizeBoxIndex].classList.remove("hidden")
            sizeSelectContinerElemnts[SizeBoxIndex].classList.add("hidden")
        }
    }
}

function hideSizeContainer(index) {
    infoContainerElemnts[index].classList.remove("hidden")
    sizeSelectContinerElemnts[index].classList.add("hidden")
}
function toggleSizeLetters(index) {
    if (sizeBoxState === "num") {
        sizeTxtElemnts[index].classList.remove("hidden")
        sizeNumElemnts[index].classList.add("hidden")
        sizeBoxState = "txt"
    } else {
        sizeTxtElemnts[index].classList.add("hidden")
        sizeNumElemnts[index].classList.remove("hidden")
        sizeBoxState = "num"
    }

}

addButtons.forEach((addButton, index) => {
    addButton.addEventListener("click", () => showSizeContainer(index));
});

sizeSloseButtonElemnts.forEach((closeButton, index) => {
    closeButton.addEventListener("click", () => hideSizeContainer(index));
});

helpButtonElemnts.forEach((helpButton, index) => {
    helpButton.addEventListener("click", () => toggleSizeLetters(index));
});


let proudctImgElemnts = document.querySelectorAll(".proudctImg");
proudctImgElemnts.forEach((proudctImgElemnt, index) => {
    let clicked = false
    const handleClick = () => {
        zoomIn(3);
        columnState = updateGrid(3, "in");
        setTimeout(() => {
            proudctsGridElemnt.style.gridTemplateColumns = `repeat(${columnState}, 1fr)`;
        }, 400);
        setTimeout(() => {
            addButtonContiners.forEach(addButtonContiner => {
                addButtonContiner.classList.remove("hidden")
            })
            proudctImgElemnt.scrollIntoView({ behavior: "auto", block: "start" });
        }, 500)
        proudctImgElemnt.removeEventListener("click", handleClick);
        updateHeader(columnState);
    };
    proudctImgElemnt.addEventListener("click", handleClick);
});
